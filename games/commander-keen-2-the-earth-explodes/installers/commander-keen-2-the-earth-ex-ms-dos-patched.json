{
  "id": 15134,
  "game_id": 29048,
  "game_slug": "commander-keen-2-the-earth-explodes",
  "name": "Commander Keen 2: The Earth Explodes",
  "year": 1990,
  "user": "appoloin",
  "runner": "dosbox",
  "slug": "commander-keen-2-the-earth-ex-ms-dos-patched",
  "version": "MS-DOS + PATCHED",
  "description": "The installer will patch the controls Space = shoot Enter = status",
  "notes": "",
  "created_at": "2019-08-25T15:07:34.299838Z",
  "updated_at": "2019-08-25T15:07:34.299866Z",
  "draft": false,
  "published": false,
  "published_by": null,
  "rating": "",
  "steamid": null,
  "gogid": null,
  "gogslug": "",
  "humblestoreid": "",
  "script": {
    "game": {
      "main_file": "$GAMEDIR/commander_keen.conf"
    },
    "files": [
      {
        "game": "N/A:Select the file Keen2.exe"
      },
      {
        "patch": "http://www.shikadi.net/wiki/files/tools/t.ckpatch_v.0.10.andrew_durdin.2007-11-23.zip"
      }
    ],
    "installer": [
      {
        "execute": {
          "args": "$GAMEDIR/HDD $GAMEDIR/HDD/keen2",
          "file": "mkdir"
        }
      },
      {
        "extract": {
          "dst": "$CACHE",
          "format": "zip",
          "file": "$patch"
        }
      },
      {
        "execute": {
          "args": "$CACHE/CK2PATCH.EXE $GAMEDIR/HDD/keen2",
          "file": "/bin/cp"
        }
      },
      {
        "write_file": {
          "content": "%ext ck2\n#Change the controls to: Space, shoot; Enter, status.\n%patch $120B  $5024W\n%patch $83A2  $5024W\n%patch $6965  $90 $90 $90 $90 $90 $90 $90 $80 $3E $5041W  $00\n%patch $6A90  $90 $90 $90 $90 $90 $90 $90 $80 $3E $5041W  $00\n%patch $6BFB  $90 $90 $90 $90 $90 $90 $90 $80 $3E $5041W  $00\n%patch $6C0E  $90 $90\n%patch $6CAF  $90 $90 $90 $90 $90 $90 $90 $80 $3E $5041W  $00\n%patch $6E3E  $90 $90 $90 $90 $90 $90 $90 $80 $3E $5041W  $00\n%patch $6EEC  $90 $90 $90 $90 $90 $90 $90 $80 $3E $5041W  $00\n%end",
          "file": "$GAMEDIR/HDD/keen2/PATCH.PAT"
        }
      },
      {
        "write_file": {
          "content": "#!/bin/bash\nsrc=$1\ndst=$2\nsrc_path=$(echo \"$1\" | sed -r \"s/(.+)\\/.+/\\1/\")\ncp -avr \"$src_path/.\"  \"$dst\"",
          "file": "$CACHE/bulkcopy.sh"
        }
      },
      {
        "chmodx": "$CACHE/bulkcopy.sh"
      },
      {
        "execute": {
          "args": "$game $GAMEDIR/HDD/keen2",
          "file": "$CACHE/bulkcopy.sh"
        }
      },
      {
        "write_file": {
          "content": "[cpu]\ncputype=386_slow\n[autoexec]\nmount C \"$GAMEDIR/HDD\" -t dir\nC:\ncd keen2\nCK2PATCH.EXE patch.pat\nexit",
          "file": "$GAMEDIR/commander_keen.conf"
        }
      }
    ]
  },
  "content": "files:\n- game: N/A:Select the file Keen2.exe\n- patch: http://www.shikadi.net/wiki/files/tools/t.ckpatch_v.0.10.andrew_durdin.2007-11-23.zip\ngame:\n  main_file: $GAMEDIR/commander_keen.conf\ninstaller:\n- execute:\n    args: $GAMEDIR/HDD $GAMEDIR/HDD/keen2\n    file: mkdir\n- extract:\n    dst: $CACHE\n    file: $patch\n    format: zip\n- execute:\n    args: $CACHE/CK2PATCH.EXE $GAMEDIR/HDD/keen2\n    file: /bin/cp\n- write_file:\n    content: '%ext ck2\n\n      #Change the controls to: Space, shoot; Enter, status.\n\n      %patch $120B  $5024W\n\n      %patch $83A2  $5024W\n\n      %patch $6965  $90 $90 $90 $90 $90 $90 $90 $80 $3E $5041W  $00\n\n      %patch $6A90  $90 $90 $90 $90 $90 $90 $90 $80 $3E $5041W  $00\n\n      %patch $6BFB  $90 $90 $90 $90 $90 $90 $90 $80 $3E $5041W  $00\n\n      %patch $6C0E  $90 $90\n\n      %patch $6CAF  $90 $90 $90 $90 $90 $90 $90 $80 $3E $5041W  $00\n\n      %patch $6E3E  $90 $90 $90 $90 $90 $90 $90 $80 $3E $5041W  $00\n\n      %patch $6EEC  $90 $90 $90 $90 $90 $90 $90 $80 $3E $5041W  $00\n\n      %end'\n    file: $GAMEDIR/HDD/keen2/PATCH.PAT\n- write_file:\n    content: '#!/bin/bash\n\n      src=$1\n\n      dst=$2\n\n      src_path=$(echo \"$1\" | sed -r \"s/(.+)\\/.+/\\1/\")\n\n      cp -avr \"$src_path/.\"  \"$dst\"'\n    file: $CACHE/bulkcopy.sh\n- chmodx: $CACHE/bulkcopy.sh\n- execute:\n    args: $game $GAMEDIR/HDD/keen2\n    file: $CACHE/bulkcopy.sh\n- write_file:\n    content: '[cpu]\n\n      cputype=386_slow\n\n      [autoexec]\n\n      mount C \"$GAMEDIR/HDD\" -t dir\n\n      C:\n\n      cd keen2\n\n      CK2PATCH.EXE patch.pat\n\n      exit'\n    file: $GAMEDIR/commander_keen.conf\n"
}